
<app-sub-menu title="Události kalendáře" (back)="goBack()" showBack="true" showEventClip="true">
    <ng-container *ngIf="calendar">
            <app-calendar-chip  [calendar_id]="calendar._id"></app-calendar-chip>
            <button mat-raised-button  (click)="onPrint()">tisk</button>
            <button mat-raised-button  (click)="onNextDay()">další den</button>
            <button mat-raised-button  (click)="onPrevDay()">předcházející den</button>
            <mat-slide-toggle
                [checked]="extra" (change)="onExtra($event)">
                <span class="mat-body">extra</span>
            </mat-slide-toggle>
    </ng-container>
</app-sub-menu>

<ng-template #xxx let-slot='slot'>
        <div *ngIf="(extra && slot.extra_slot) || (!extra && slot.normal_slot)" fxLayout="row"  class="boxitem">
             <div class="time mat-title"> {{slot.slot | tstime:calendar.span }} {{slot.slot}} </div> 
             <div *ngIf="slot.event && slot.event_leg==0" class="type_color"  [ngStyle]="{'background-color': slot.event.color}">&nbsp;</div>         
             <div class="name mat-title" fxFlex="1 1 auto" (click)="onSlot(slot)"> 
                 <span *ngIf="slot.event_leg==0">{{slot.event?.client.last_name}} {{slot.event?.client.first_name}} len:{{slot.event?.len}}</span>
            </div>
        </div>
</ng-template>

<mat-progress-bar *ngIf="loading" mode="indeterminate" class="loading"></mat-progress-bar>

<div class="container" fxLayout="column" fxLayoutAlign="start start" fxLayoutGap="10px">
    <div *ngIf="slots" fxLayout="row wrap" fxLayoutAlign="start start" >
        <div class="leftpanel" fxFlex="1 1 auto" fxLayout="column" fxLayoutAlign="start center" fxLayoutGap="10px">
            <app-daycard [date]="day"></app-daycard>
        </div>
        <div class="rightpanel mat-elevation-z8" fxFlex="5 1 auto">
            <ng-container *ngFor="let slot of slots">
                <ng-content *ngTemplateOutlet='xxx; context:{slot:slot}'></ng-content>
            </ng-container>
        </div>
      </div>
</div>
<app-diag>{{diag}}</app-diag>